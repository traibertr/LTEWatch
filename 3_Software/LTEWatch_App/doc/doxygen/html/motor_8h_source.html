<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LTEWatch: C:/LTEWatch/3_Software/LTEWatch_App/src/library/mdw/partners/motor/motor.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">LTEWatch<span id="projectnumber">&#160;1.0</span>
   </div>
   <div id="projectbrief">Master Thesis - LTE-M/NB-IoT &amp; GNSS - Smart-Watch Application</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_6ab26b8f8288766417183ba84f11792f.html">LTEWatch</a></li><li class="navelem"><a class="el" href="dir_888ee635cf41b949de71faf540dee5be.html">3_Software</a></li><li class="navelem"><a class="el" href="dir_26dd36a933a22666a39ff78475860faa.html">LTEWatch_App</a></li><li class="navelem"><a class="el" href="dir_f0d941fa9697254e954d573811a41f3b.html">src</a></li><li class="navelem"><a class="el" href="dir_ad1c194472ae4825fc2ac47ed5e6e5f3.html">library</a></li><li class="navelem"><a class="el" href="dir_4f5b25a4326dde5d057182c8df9f9a77.html">mdw</a></li><li class="navelem"><a class="el" href="dir_5ec594d7ff1236beeecf93b04d99e035.html">partners</a></li><li class="navelem"><a class="el" href="dir_cf304a789fa72a79d240baf0e2a0ce4e.html">motor</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">motor.h</div></div>
</div><!--header-->
<div class="contents">
<a href="motor_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/****************************************************************************************************************/</span></div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="preprocessor">#pragma once</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span> </div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="comment">/* **************************************************************************************************************** */</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="comment">/*                                                                                                                  */</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span><span class="comment">/* Header files                                                                                                     */</span></div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span><span class="comment">/*                                                                                                                  */</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span><span class="comment">/* **************************************************************************************************************** */</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span><span class="preprocessor">#include &lt;<a class="code" href="platform-config_8h.html">platform-config.h</a>&gt;</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span> </div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="preprocessor">#if (USE_MOTORS != 0)</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span><span class="preprocessor">#include &quot;motor-config.h&quot;</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span> </div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span><span class="preprocessor">#include &quot;<a class="code" href="motorid_8h.html">motorid.h</a>&quot;</span></div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="preprocessor">#include &quot;<a class="code" href="motorpersistor_8h.html">motorpersistor.h</a>&quot;</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span> </div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span><span class="comment">//#include &quot;flash/interface/persister.h&quot;</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span> </div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span><span class="comment">/* **************************************************************************************************************** */</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span><span class="comment">/*                                                                                                                  */</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span><span class="comment">/* APPLICATION defintion                                                                                            */</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span><span class="comment">/*                                                                                                                  */</span></div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span><span class="comment">/* **************************************************************************************************************** */</span></div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span> </div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span><span class="comment">/* **************************************************************************************************************** */</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span><span class="comment">/*                                                                                                                  */</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span><span class="comment">/* NAMESPACE Declaration                                                                                            */</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span><span class="comment">/*                                                                                                                  */</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span><span class="comment">/* **************************************************************************************************************** */</span></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span><span class="keyword">namespace </span>motor</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>{</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span> </div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    <span class="comment">/* ************************************************************************************************************ */</span></div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>    <span class="comment">/*                                                                                                              */</span></div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    <span class="comment">/* Class Declaration                                                                                            */</span></div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    <span class="comment">/*                                                                                                              */</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    <span class="comment">/* ************************************************************************************************************ */</span></div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>    <span class="keyword">class </span><a class="code hl_class" href="classmotor_1_1_motor.html">Motor</a></div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    #if (USE_FLASH != 0)</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>        : <span class="keyword">public</span> flash::Persister</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>    #endif  <span class="comment">// #if (USE_FLASH != 0)</span></div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    {</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    <span class="keyword">public</span>:</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>        <span class="comment">/* ******************************************************************************************************** */</span></div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>        <span class="comment">/*                                                                                                          */</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>        <span class="comment">/* PUBLIC DECLARATION SECTION                                                                               */</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>        <span class="comment">/*                                                                                                          */</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>        <span class="comment">/* ******************************************************************************************************** */</span></div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>        <span class="keyword">typedef</span> <span class="keyword">enum</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>        {</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>            zeroSteps       =   0,</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>            SixtySteps      =  60,</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>            OneTwentySteps  = 120,</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>            OneEightySteps  = 180,</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>            TwoFourtySteps  = 240,</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>            ThreeSixtySteps = 360</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>        } eNbSteps;</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span> </div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>        <span class="keywordtype">void</span> initialize(<span class="keywordtype">bool</span>              hotReset,</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>                        <a class="code hl_enumeration" href="classmotor_1_1_motor_id.html#a0f8ba4bf93cd9b126ed7498e1418ef65">MotorId::eMotorId</a> <span class="keywordtype">id</span>                 = <a class="code hl_enumvalue" href="classmotor_1_1_motor_id.html#a0f8ba4bf93cd9b126ed7498e1418ef65a76495ec91230435a10d7a798f4f4d015">MotorId::UnknownMotor</a>,</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>                        Motor::eNbSteps   nbSteps            = Motor::OneEightySteps,</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>                        uint8_t           nbStepsForTick     = 1,</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>                        uint8_t           coilA              = 0,</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>                        uint8_t           coilB              = 1,</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>                        uint8_t           coilC              = 2,</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>                        <span class="keywordtype">bool</span>              inverseRotation    = <span class="keyword">false</span>,</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>                        uint8_t           nbStepsForFastInit = 15);</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span> </div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span> </div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>        <span class="keyword">inline</span> uint8_t id()<span class="keyword"> const                       </span>{ <span class="keywordflow">return</span> _id; }</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>        <span class="keyword">inline</span> uint8_t motorPositionIndex()<span class="keyword"> const       </span>{ <span class="keywordflow">return</span> _motorPosIndex; }</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span> </div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>        <span class="keyword">inline</span> uint16_t position()<span class="keyword"> const                </span>{ <span class="keywordflow">return</span> _persistentParams.position(); }</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span> </div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>        <span class="keyword">inline</span> uint16_t destination()<span class="keyword"> const             </span>{ <span class="keywordflow">return</span> _destination; }</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span> </div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>        <span class="keyword">inline</span> uint16_t nbSteps()<span class="keyword"> const                 </span>{ <span class="keywordflow">return</span> _nbSteps; }</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span> </div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>        <span class="keyword">inline</span> uint16_t nbStepsHalf()<span class="keyword"> const             </span>{ <span class="keywordflow">return</span> _nbStepsHalf; }</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span> </div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>        <span class="keyword">inline</span> uint16_t nbStepsThreeHalf()<span class="keyword"> const        </span>{ <span class="keywordflow">return</span> _nbStepsThreeHalf; }</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span> </div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>        <span class="keyword">inline</span> uint8_t nbStepsForTick()<span class="keyword"> const           </span>{ <span class="keywordflow">return</span> _nbStepsForTick; }</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span> </div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>        <span class="keyword">inline</span> uint16_t nbStepsForFastInit()<span class="keyword"> const      </span>{ <span class="keywordflow">return</span> _nbStepsForFastInit; }</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span> </div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>        <span class="keyword">inline</span> uint16_t nbStepsForAnimation()<span class="keyword"> const     </span>{ <span class="keywordflow">return</span> _nbStepsForAnimation; }</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span> </div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>        <span class="keyword">inline</span> <span class="keywordtype">bool</span> isGoingForward()<span class="keyword"> const              </span>{ <span class="keywordflow">return</span> _clockwise; }</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span> </div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>        <span class="keyword">inline</span> uint8_t coilA()<span class="keyword"> const                    </span>{ <span class="keywordflow">return</span> _coilA; }</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span> </div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>        <span class="keyword">inline</span> uint8_t coilB()<span class="keyword"> const                    </span>{ <span class="keywordflow">return</span> _coilB; }</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span> </div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>        <span class="keyword">inline</span> uint8_t coilC()<span class="keyword"> const                    </span>{ <span class="keywordflow">return</span> _coilC; }</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span> </div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>        <span class="keyword">inline</span> uint8_t* activeCoilEndPoints()          { <span class="keywordflow">return</span> _activeCoilEndPoint; }</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span> </div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>        <span class="keyword">inline</span> <span class="keyword">const</span> uint8_t* activePulse()</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>        {</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>            <span class="keywordflow">return</span> _PULSE[(_clockwise &amp;&amp; !_inverseRotation) || (!_clockwise &amp;&amp; _inverseRotation)]</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>                   [_persistentParams.alim()];</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>        }</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span> </div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>        <span class="keyword">inline</span> uint8_t stepThreshold()<span class="keyword"> const            </span>{ <span class="keywordflow">return</span> _stepThreshold; }</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span> </div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>        <span class="keyword">inline</span> <span class="keywordtype">bool</span>  isReversed()<span class="keyword"> const                 </span>{ <span class="keywordflow">return</span> _inverseRotation; }</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span> </div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>        <span class="keyword">inline</span> uint64_t motorGpioMask()<span class="keyword"> const           </span>{ <span class="keywordflow">return</span> _motorGpioMask; }</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span> </div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>        <span class="keyword">inline</span> uint32_t singleGapTick()<span class="keyword"> const           </span>{ <span class="keywordflow">return</span> _singleGapTick; }</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span> </div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>        <span class="keyword">inline</span> uint32_t stepCounter()<span class="keyword"> const             </span>{ <span class="keywordflow">return</span> _persistentParams.stepCounter(); }</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span> </div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>        <span class="keyword">inline</span> int8_t forceDirection()<span class="keyword"> const            </span>{ <span class="keywordflow">return</span> _forceDirection; }</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span> </div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>        <span class="keyword">inline</span> <span class="keywordtype">void</span> resetDestination()                  { _destination = _persistentParams.position(); }</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span> </div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>        <span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">char</span>* toString()<span class="keyword"> const             </span>{ <span class="keywordflow">return</span> <a class="code hl_function" href="classmotor_1_1_motor_id.html#afb7bf121de6f00a0a1fc2e032c553cc2">MotorId::toString</a>(MotorId::fromInt(_id)); }</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span> </div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span> </div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>        <span class="keywordtype">void</span> setPosition(uint16_t position);</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span> </div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>        <span class="keywordtype">void</span> setDestination(uint16_t destination);</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span> </div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>        <span class="keywordtype">void</span> setDirectionConfiguration(<span class="keywordtype">bool</span> clockwise);</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span> </div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>        <span class="keywordtype">void</span> setDirection(<span class="keywordtype">bool</span> clockwise);</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span> </div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>        <span class="keywordtype">void</span> setForceDirection(int8_t forceDirection);</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span> </div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>        <span class="keywordtype">void</span> setNbStepsForTick(uint8_t nbStepsForTick);</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span> </div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>        <span class="keywordtype">void</span> setMotorPositionIndex(uint8_t index);</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span> </div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>        <span class="keywordtype">void</span> setMotorSteps(uint16_t steps);</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span> </div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>        <span class="keywordtype">void</span> setMotorStepsForFastInit(uint16_t stepsForFastInit);</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span> </div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>        <span class="keywordtype">void</span> setStepThreshold(uint8_t stepThreshold);</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span> </div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span> </div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>        <span class="keyword">inline</span> <span class="keywordtype">void</span> toggleAlim()                        { _persistentParams.toggleAlim(); }</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span> </div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>        <span class="keywordtype">void</span> stepForward();</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span> </div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>        <span class="keywordtype">void</span> singleStepForward();</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span> </div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>        <span class="keywordtype">void</span> stepBackward();</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span> </div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>        <span class="keywordtype">void</span> singleStepBackward();</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span> </div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>        <span class="keywordtype">void</span> updateNbStepsForAnimation(<span class="keywordtype">bool</span> synchronousModeEnabled, uint8_t factor);</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span> </div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>        <span class="keywordtype">void</span> updatePosition();</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span> </div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>        <span class="keywordtype">void</span> setSingleGapTick(uint32_t gapTick);</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span> </div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span><span class="preprocessor">    #if (USE_FLASH != 0)</span></div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span><span class="comment">        /********************************************************************************************************/</span></div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>        <span class="keyword">virtual</span> uint32_t* save(uint16_t* size);</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>        <span class="keyword">virtual</span> <span class="keywordtype">void</span> restore(uint32_t* data);</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span><span class="preprocessor">#endif  </span><span class="comment">// #if (USE_FLASH != 0)</span></div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span> </div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>    <span class="keyword">private</span>:</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>        <span class="comment">/* ******************************************************************************************************** */</span></div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>        <span class="comment">/*                                                                                                          */</span></div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>        <span class="comment">/* PRIVATE DECLARATION SECTION                                                                              */</span></div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>        <span class="comment">/*                                                                                                          */</span></div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>        <span class="comment">/* ******************************************************************************************************** */</span></div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>        <span class="comment">// Attributes</span></div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span> </div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>        <span class="comment">// 3 dimensional array to store the pulse to be applied on the coils. 1st dimension is the direction (CW or</span></div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>        <span class="comment">// CCW), 2nd dimension is the alimentation of the coils (drive by _alim) and 3rd is the state of the 3 GPIOs</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>        <span class="comment">// used to drive the coils.</span></div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>        <span class="keyword">static</span> <span class="keyword">const</span> uint8_t _PULSE[2][2][3];</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span> </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>        <span class="comment">// Persistent parameters</span></div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>        <a class="code hl_class" href="classmotor_1_1_motor_persistor.html">motor::MotorPersistor</a>   _persistentParams;</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span> </div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>        <span class="comment">// to store the GPIO assign to CoilA, CoilB and CoilC</span></div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>        uint8_t                 _coilA;</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>        uint8_t                 _coilB;</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>        uint8_t                 _coilC;</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>        uint8_t                 _activeCoilEndPoint[3];</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span> </div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>        <span class="comment">// to know which motor to work with</span></div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>        uint8_t                 _id;</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span> </div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>        <span class="comment">// to know the index of the motor we are working with</span></div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>        uint8_t                 _motorPosIndex;</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span> </div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>        <span class="comment">// The next position</span></div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>        uint16_t                _destination;</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span> </div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>        <span class="comment">// Number of steps of the stepper motor</span></div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>        uint16_t                _nbSteps;</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>        uint16_t                _nbStepsHalf;</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>        uint16_t                _nbStepsThreeHalf;</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span> </div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>        <span class="comment">// steps to do to reach the next main position</span></div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>        uint8_t                 _nbStepsForTick;</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span> </div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>        <span class="comment">// Watch movement don&#39;t always use motors with the same step&#39;s number. To give the impression that all motors</span></div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>        <span class="comment">// are rotating simultaneously, the motors with the less of motor&#39;s steps should not make a step at each</span></div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>        <span class="comment">// turn... This is store int the variable below</span></div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>        uint8_t                 _stepThreshold;</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span> </div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>        <span class="comment">// steps to do when Motor initalisation mode is enabled</span></div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>        uint16_t                _nbStepsForFastInit;</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span> </div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>        <span class="comment">// steps to do during animation in initialisation mode</span></div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>        uint16_t                _nbStepsForAnimation;</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span> </div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>        <span class="comment">// Mask of the GPIOs used for driving the motor&#39;s coils.</span></div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>        uint64_t                _motorGpioMask;</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span> </div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>        <span class="comment">// Tick counter for the gap time to wait between two motor&#39;s steps when only one motor is moving</span></div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>        uint32_t                _singleGapTick;</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span> </div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>        <span class="comment">// Keep the direction of the motor&#39;s rotation. TRUE means clockwise and FALSE to rotate counter-clockwise</span></div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>        <span class="keywordtype">bool</span>                    _clockwise;</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>        int8_t                  _forceDirection;</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span> </div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>        <span class="comment">// Due to mechanical construction, some motors rotate CCW with a CW impulse... To take care of this fact,</span></div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>        <span class="comment">// we&#39;ve introduced this variable;</span></div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>        <span class="keywordtype">bool</span>                    _inverseRotation;</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>        <span class="keywordtype">bool</span>                    _clockwiseConfiguration;</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>    };</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span> </div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>}   <span class="comment">// Namespace motor</span></div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span> </div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span><span class="preprocessor">#endif </span><span class="comment">// #if (USE_MOTORS != 0)</span></div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>   <span class="comment">// Group: Motor</span></div>
<div class="ttc" id="aclassmotor_1_1_motor_html"><div class="ttname"><a href="classmotor_1_1_motor.html">Motor</a></div><div class="ttdoc">Class that manages a bidirectional stepper motor.</div></div>
<div class="ttc" id="aclassmotor_1_1_motor_id_html_a0f8ba4bf93cd9b126ed7498e1418ef65"><div class="ttname"><a href="classmotor_1_1_motor_id.html#a0f8ba4bf93cd9b126ed7498e1418ef65">motor::MotorId::eMotorId</a></div><div class="ttdeci">eMotorId</div><div class="ttdef"><b>Definition:</b> motorid.h:59</div></div>
<div class="ttc" id="aclassmotor_1_1_motor_id_html_a0f8ba4bf93cd9b126ed7498e1418ef65a76495ec91230435a10d7a798f4f4d015"><div class="ttname"><a href="classmotor_1_1_motor_id.html#a0f8ba4bf93cd9b126ed7498e1418ef65a76495ec91230435a10d7a798f4f4d015">motor::MotorId::UnknownMotor</a></div><div class="ttdeci">@ UnknownMotor</div><div class="ttdoc">Unknown motor (not initialized).</div><div class="ttdef"><b>Definition:</b> motorid.h:60</div></div>
<div class="ttc" id="aclassmotor_1_1_motor_id_html_afb7bf121de6f00a0a1fc2e032c553cc2"><div class="ttname"><a href="classmotor_1_1_motor_id.html#afb7bf121de6f00a0a1fc2e032c553cc2">motor::MotorId::toString</a></div><div class="ttdeci">static const char * toString(eMotorId id)</div><div class="ttdoc">Returns the string which describes the given Motor.</div><div class="ttdef"><b>Definition:</b> motorid.h:92</div></div>
<div class="ttc" id="aclassmotor_1_1_motor_persistor_html"><div class="ttname"><a href="classmotor_1_1_motor_persistor.html">MotorPersistor</a></div><div class="ttdoc">Class that handles motor's parameters to be saved and restore before and after DFU....</div></div>
<div class="ttc" id="amotorid_8h_html"><div class="ttname"><a href="motorid_8h.html">motorid.h</a></div></div>
<div class="ttc" id="amotorpersistor_8h_html"><div class="ttname"><a href="motorpersistor_8h.html">motorpersistor.h</a></div></div>
<div class="ttc" id="aplatform-config_8h_html"><div class="ttname"><a href="platform-config_8h.html">platform-config.h</a></div><div class="ttdoc">This file is used to enable/disable all the different peripherals and features for PCA10056 project.</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
